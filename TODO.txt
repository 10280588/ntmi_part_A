smoothing in a good way
prob not efficiently calculated? (not using viterbi i think)